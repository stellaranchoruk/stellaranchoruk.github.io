<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mirrasets Stellar Wallet Demo</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    #public-key { margin-top: 1rem; word-break: break-all; }
    button { padding: 0.5rem 1rem; font-size: 1rem; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Connect your Stellar Wallet</h1>
  <button id="connect-btn">Connect with Freighter</button>
  <div id="public-key"></div>

  <!-- Use JSDelivr ES-module build (CORS-safe) -->
  <script type="module">
    import {
      StellarWalletsKit,
      WalletNetwork,
      FreighterModule
    } from 'https://cdn.jsdelivr.net/npm/@creit.tech/stellar-wallets-kit@latest/dist/index.esm.js';

    const freighter = new FreighterModule();
    const kit = new StellarWalletsKit({
      network: WalletNetwork.PUBLIC,
      selectedWalletId: freighter.productId,
      modules: [freighter],
    });

    document.getElementById('connect-btn').addEventListener('click', async () => {
      try {
        await kit.openModal({
          modalTitle: 'Connect your Stellar wallet',
          onWalletSelected: async (wallet) => {
            await kit.setWallet(wallet.id);
            const { address } = await kit.getAddress();
            document.getElementById('public-key').textContent =
              `Your public key: ${address}`;
          },
          onClosed: err => { if (err) console.error('Modal closed:', err); }
        });
      } catch (e) {
        console.error('Failed to open modal:', e);
      }
    });
  </script>
</body>
</html>
